import { Injectable } from '@angular/core';
import {loadSynergy, player} from '../Synergism/Synergism';
import {CalcCorruptionStuff, calculateAscensionAcceleration, calculatePowderConversion} from '../Synergism/Calculate';
import {calculateGoldenQuarkGain} from '../Synergism/Reset';
import {Subject} from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class SynerLinkService {
  subject = new Subject();

  constructor() { }

  async load(saveImport?: string) {
    if (!saveImport) return;

    let imp = `eyJ3b3JsZHMiOjc1NzAuNDY5OTk5OTk5NDkzLCJjb2lucyI6IkluZmluaXR5IiwiY29pbnNUaGlzUHJlc3RpZ2UiOiJJbmZpbml0eSIsImNvaW5zVGhpc1RyYW5zY2Vuc2lvbiI6IkluZmluaXR5IiwiY29pbnNUaGlzUmVpbmNhcm5hdGlvbiI6IkluZmluaXR5IiwiY29pbnNUb3RhbCI6IkluZmluaXR5IiwibXVsdGlwbGllckNvc3QiOiJJbmZpbml0eSIsIm11bHRpcGxpZXJCb3VnaHQiOjM3NTQ3ODA0NzY1NjgsImFjY2VsZXJhdG9yQ29zdCI6IkluZmluaXR5IiwiYWNjZWxlcmF0b3JCb3VnaHQiOjM3NTQ3ODA0NzcwMDcsImFjY2VsZXJhdG9yQm9vc3RCb3VnaHQiOjE3ODkxODMsImFjY2VsZXJhdG9yQm9vc3RDb3N0IjoiMWUrMTYwMDYwNjY5MDE2OSIsInVwZ3JhZGVzIjpbMCwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDBdLCJwcmVzdGlnZUNvdW50IjoyNzg3MDU4NS42LCJ0cmFuc2NlbmRDb3VudCI6Mjc4MDM3NzEuNiwicmVpbmNhcm5hdGlvbkNvdW50IjoyNDM1OTY2NC41ODc1MzUzNjYsInByZXN0aWdlUG9pbnRzIjoiNC41Mjg3MzY2OTYyMzEzMWUrMTYwMDYwNTQxMDE2MiIsInRyYW5zY2VuZFBvaW50cyI6IkluZmluaXR5IiwicmVpbmNhcm5hdGlvblBvaW50cyI6IjYuNjM3NzIyMTQyODQ3NjllKzE3OTM3NTc3MDA3MDUiLCJwcmVzdGlnZVNoYXJkcyI6IjkuOTg3NTkwNjU3MjEwNDc1ZSs1NDc0MTAzMDc4OTQwNDIiLCJ0cmFuc2NlbmRTaGFyZHMiOiI1Ljg1NjQ4MzIxNDYyNTUxZSsxNzkzNzU3NzAwNzIwODEiLCJyZWluY2FybmF0aW9uU2hhcmRzIjoiMS4wNzE5ODExNTg3OTU0N2UrNTg1NjAwMCIsInRvZ2dsZXMiOnsiMSI6dHJ1ZSwiMiI6dHJ1ZSwiMyI6dHJ1ZSwiNCI6dHJ1ZSwiNSI6dHJ1ZSwiNiI6dHJ1ZSwiNyI6dHJ1ZSwiOCI6dHJ1ZSwiOSI6dHJ1ZSwiMTAiOnRydWUsIjExIjp0cnVlLCIxMiI6dHJ1ZSwiMTMiOnRydWUsIjE0Ijp0cnVlLCIxNSI6ZmFsc2UsIjE2Ijp0cnVlLCIxNyI6dHJ1ZSwiMTgiOnRydWUsIjE5Ijp0cnVlLCIyMCI6dHJ1ZSwiMjEiOmZhbHNlLCIyMiI6dHJ1ZSwiMjMiOnRydWUsIjI0Ijp0cnVlLCIyNSI6dHJ1ZSwiMjYiOnRydWUsIjI3IjpmYWxzZSwiMjgiOmZhbHNlLCIyOSI6ZmFsc2UsIjMwIjpmYWxzZSwiMzEiOmZhbHNlLCIzMiI6ZmFsc2UsIjMzIjpmYWxzZX0sImNoYWxsZW5nZWNvbXBsZXRpb25zIjpbMCwxMTc0LDEwNDgsMTAwMCwxMDI2LDEwMDAsOTQsMTA3LDEyMCw3OSw4NCw2MCw2MCw1Niw2MCwwXSwiaGlnaGVzdGNoYWxsZW5nZWNvbXBsZXRpb25zIjpbMCwxMTc0LDEwNDgsMTAwMCwxMDI2LDEwMDAsOTQsMTA3LDEyMCw3OSw4NCw2MCw2MCw1Niw2MCwwXSwiY2hhbGxlbmdlMTVFeHBvbmVudCI6My45ODAzODU3MzU1NDk4MjVlKzIzLCJoaWdoZXN0Q2hhbGxlbmdlMTVFeHBvbmVudCI6MCwicmV0cnljaGFsbGVuZ2VzIjp0cnVlLCJjdXJyZW50Q2hhbGxlbmdlIjp7InRyYW5zY2Vuc2lvbiI6MCwicmVpbmNhcm5hdGlvbiI6MCwiYXNjZW5zaW9uIjowfSwicmVzZWFyY2hQb2ludHMiOjEuNTg3ODMwNzE3MTcxODI3NmUrNjQsIm9idGFpbml1bXRpbWVyIjowLCJvYnRhaW5pdW1wZXJzZWNvbmQiOjUuMzExMDQxMTM4Mzk1MDc0NGUrMjIsIm1heG9idGFpbml1bXBlcnNlY29uZCI6NS4zMTEwNDExMzgzOTUwNzQ0ZSsyMiwibWF4b2J0YWluaXVtIjozLjQ0OTQ2NDk4ODg1MDA2NjVlKzIyMCwicmVzZWFyY2hlcyI6WzAsMSwxLDEsMSwxLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEwLDEsMSwxLDI1LDI1LDI1LDIwLDIwLDEwLDEwLDEwLDEwLDEwLDEyLDEyLDEwLDEwLDEwLDEwLDEwLDEwLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEwLDEwLDEwLDEwLDEwLDIwLDIwLDIwLDIwLDIwLDEsNSw0LDUsNSwxMCwxMCwxMCwxMCwxMCwxLDEsMSwxLDEsMTAsNTAsNTAsNTAsNTAsMTAsMSwyMCwyMCwyMCwyMCwyMCwyMCwyMCwxMCwyMCwyMCwyMCwyMCwxLDIwLDUsNSwzLDIsMTAsMTAsMTAsMTAsMSwxMCwxMCwyMCwyNSwyNSw1MCw1MCw1MCw1MCwxMDAsMTAsMTAsMTAsMTAwLDEwMCwyNSwyNSwyNSwxLDUsMTAsMTAsMTAsMTAsMSwxMCwxMCwxMCwxLDEsMjUsMjUsMjUsMTUsMSwxMCwxMCwxMCwxMCwxLDEwLDEsNiwxMCwxLDI1LDI1LDEsMTUsMSwxMCwxMCwxMCwxLDEsMTAsMTAsMTAsMTAsMSwyNSwyNSwyNSwxNSwxLDEwLDEwLDEwLDEsMSwxMCwzLDYsMTAsNSwyNSwyNSwxLDE1LDEsMjAsMjAsMjAsMSwxLDIwLDEsNTAsNTAsMTAsMjUsMjUsMjUsMTUsMTAwMDAwXSwidW5sb2NrcyI6eyJjb2lub25lIjp0cnVlLCJjb2ludHdvIjp0cnVlLCJjb2ludGhyZWUiOnRydWUsImNvaW5mb3VyIjp0cnVlLCJwcmVzdGlnZSI6dHJ1ZSwiZ2VuZXJhdGlvbiI6dHJ1ZSwidHJhbnNjZW5kIjp0cnVlLCJyZWluY2FybmF0ZSI6dHJ1ZSwicnJvdzEiOnRydWUsInJyb3cyIjp0cnVlLCJycm93MyI6dHJ1ZSwicnJvdzQiOnRydWV9LCJhY2hpZXZlbWVudHMiOlswLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwwLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDAsMCwxLDEsMSwxLDEsMSwxLDEsMCwwLDAsMCwwLDBdLCJhY2hpZXZlbWVudFBvaW50cyI6NjYzNSwicHJlc3RpZ2Vub211bHRpcGxpZXIiOmZhbHNlLCJwcmVzdGlnZW5vYWNjZWxlcmF0b3IiOmZhbHNlLCJ0cmFuc2NlbmRub211bHRpcGxpZXIiOmZhbHNlLCJ0cmFuc2NlbmRub2FjY2VsZXJhdG9yIjpmYWxzZSwicmVpbmNhcm5hdGVub211bHRpcGxpZXIiOmZhbHNlLCJyZWluY2FybmF0ZW5vYWNjZWxlcmF0b3IiOmZhbHNlLCJwcmVzdGlnZW5vY29pbnVwZ3JhZGVzIjpmYWxzZSwidHJhbnNjZW5kbm9jb2ludXBncmFkZXMiOmZhbHNlLCJ0cmFuc2NlbmRub2NvaW5vcnByZXN0aWdldXBncmFkZXMiOmZhbHNlLCJyZWluY2FybmF0ZW5vY29pbnVwZ3JhZGVzIjpmYWxzZSwicmVpbmNhcm5hdGVub2NvaW5vcnByZXN0aWdldXBncmFkZXMiOmZhbHNlLCJyZWluY2FybmF0ZW5vY29pbnByZXN0aWdlb3J0cmFuc2NlbmR1cGdyYWRlcyI6ZmFsc2UsInJlaW5jYXJuYXRlbm9jb2lucHJlc3RpZ2V0cmFuc2NlbmRvcmdlbmVyYXRvcnVwZ3JhZGVzIjpmYWxzZSwiY3J5c3RhbFVwZ3JhZGVzIjpbMzg2OTIwNDksMzU1MzY5NTIsMzQzOTIzNjYsMzIyMjUzMzIsMzAzMDI0NTUsMjY5ODkxOTQsMjY5ODkxOTQsMjY5ODkxOTRdLCJjcnlzdGFsVXBncmFkZXNDb3N0IjpbNywxNSwyMCw0MCwxMDAsMjAwLDUwMCwxMDAwXSwicnVuZWxldmVscyI6WzM1ODI1LDM1NjQyLDM1NjE5LDM1NDU2LDM1MDI0LDkyLDFdLCJydW5lZXhwIjpbMS4wMDU5MTkwOTMyNDU0NDNlKzEzOCwxLjAwMTI4NjI5OTQ3MDkxMTRlKzEzOCwxLjg4NzE5MDI3NDk1MzUzNjNlKzEzOCw5Ljc3NTk5OTI4NjQ5NzY5NmUrMTM3LDIuMzA3MDc3OTkxNjk4OTI0NWUrMTM4LDFlKzI1NywyZSsyNTZdLCJydW5lc2hhcmRzIjoxMCwibWF4b2ZmZXJpbmdzIjoxLjYxOTI5Njc1MDE4MzMxOTdlKzE3Nywib2ZmZXJpbmdwZXJzZWNvbmQiOjEuMTkxODM3MDYxOTc1MTAyNmUrNzksInByZXN0aWdlY291bnRlciI6MC4wMDAwMDE5MTkxNTc0OTc2NjQ2MDEsInRyYW5zY2VuZGNvdW50ZXIiOjAuMDAwMDAxOTE5MTU3NDk3NjY0NjAxLCJyZWluY2FybmF0aW9uY291bnRlciI6MC4wMDAwMDE5MTkxNTc0OTc2NjQ2MDEsIm9mZmxpbmV0aWNrIjoxNjUxODY5NTA4NjgyLCJwcmVzdGlnZWFtb3VudCI6MSwidHJhbnNjZW5kYW1vdW50IjoyLCJyZWluY2FybmF0aW9uYW1vdW50IjowLjE1LCJmYXN0ZXN0cHJlc3RpZ2UiOjAsImZhc3Rlc3R0cmFuc2NlbmQiOjAsImZhc3Rlc3RyZWluY2FybmF0ZSI6MCwicmVzZXR0b2dnbGUxIjoyLCJyZXNldHRvZ2dsZTIiOjIsInJlc2V0dG9nZ2xlMyI6MiwidGVzc2VyYWN0QXV0b0J1eWVyVG9nZ2xlIjoyLCJ0ZXNzZXJhY3RBdXRvQnV5ZXJBbW91bnQiOjAsImNvaW5idXlhbW91bnQiOjEwMDAsImNyeXN0YWxidXlhbW91bnQiOjEwMDAsIm15dGhvc2J1eWFtb3VudCI6MTAwMCwicGFydGljbGVidXlhbW91bnQiOjEwMDAsIm9mZmVyaW5nYnV5YW1vdW50IjoxLCJ0ZXNzZXJhY3RidXlhbW91bnQiOjEsInNob3B0b2dnbGVzIjp7ImNvaW4iOnRydWUsInByZXN0aWdlIjp0cnVlLCJ0cmFuc2NlbmQiOnRydWUsImdlbmVyYXRvcnMiOnRydWUsInJlaW5jYXJuYXRlIjp0cnVlfSwidGFibnVtYmVyIjo1LCJzdWJ0YWJOdW1iZXIiOjEsImNvZGVzIjpbWzEsdHJ1ZV0sWzIsZmFsc2VdLFszLGZhbHNlXSxbNCxmYWxzZV0sWzUsZmFsc2VdLFs2LGZhbHNlXSxbNyxmYWxzZV0sWzgsZmFsc2VdLFs5LGZhbHNlXSxbMTAsZmFsc2VdLFsxMSxmYWxzZV0sWzEyLGZhbHNlXSxbMTMsZmFsc2VdLFsxNCxmYWxzZV0sWzE1LGZhbHNlXSxbMTYsZmFsc2VdLFsxNyxmYWxzZV0sWzE4LGZhbHNlXSxbMTksZmFsc2VdLFsyMCxmYWxzZV0sWzIxLGZhbHNlXSxbMjIsZmFsc2VdLFsyMyxmYWxzZV0sWzI0LGZhbHNlXSxbMjUsZmFsc2VdLFsyNixmYWxzZV0sWzI3LGZhbHNlXSxbMjgsZmFsc2VdLFsyOSxmYWxzZV0sWzMwLGZhbHNlXSxbMzEsZmFsc2VdLFszMixmYWxzZV0sWzMzLGZhbHNlXSxbMzQsZmFsc2VdLFszNSxmYWxzZV0sWzM2LGZhbHNlXSxbMzcsdHJ1ZV0sWzM4LGZhbHNlXSxbMzksdHJ1ZV1dLCJsb2FkZWQxMDA5Ijp0cnVlLCJsb2FkZWQxMDA5aG90Zml4MSI6dHJ1ZSwibG9hZGVkMTAwOTEiOnRydWUsImxvYWRlZDEwMTAiOnRydWUsImxvYWRlZDEwMTAxIjp0cnVlLCJzaG9wVXBncmFkZXMiOnsib2ZmZXJpbmdQb3Rpb24iOjAsIm9idGFpbml1bVBvdGlvbiI6MCwib2ZmZXJpbmdFWCI6MCwib2ZmZXJpbmdBdXRvIjoxLCJvYnRhaW5pdW1FWCI6MCwib2J0YWluaXVtQXV0byI6MSwiaW5zdGFudENoYWxsZW5nZSI6MSwiYW50U3BlZWQiOjAsImNhc2hHcmFiIjowLCJzaG9wVGFsaXNtYW4iOjEsInNlYXNvblBhc3MiOjAsImNoYWxsZW5nZUV4dGVuc2lvbiI6NSwiY2hhbGxlbmdlVG9tZSI6MTUsImN1YmVUb1F1YXJrIjoxLCJ0ZXNzZXJhY3RUb1F1YXJrIjoxLCJoeXBlcmN1YmVUb1F1YXJrIjoxLCJzZWFzb25QYXNzMiI6MCwic2Vhc29uUGFzczMiOjAsImNocm9ub21ldGVyIjo4NywiaW5maW5pdGVBc2NlbnQiOjEsImNhbGN1bGF0b3IiOjUsImNhbGN1bGF0b3IyIjoxMiwiY2FsY3VsYXRvcjMiOjEwLCJjb25zdGFudEVYIjoyLCJwb3dkZXJFWCI6NTAsImNocm9ub21ldGVyMiI6MTksImNocm9ub21ldGVyMyI6MzQsInNlYXNvblBhc3NZIjowLCJzZWFzb25QYXNzWiI6MjYsImNoYWxsZW5nZVRvbWUyIjowfSwiYXV0b1NhY3JpZmljZVRvZ2dsZSI6dHJ1ZSwiYXV0b0ZvcnRpZnlUb2dnbGUiOnRydWUsImF1dG9FbmhhbmNlVG9nZ2xlIjp0cnVlLCJhdXRvUmVzZWFyY2hUb2dnbGUiOnRydWUsImF1dG9SZXNlYXJjaE1vZGUiOiJjaGVhcGVzdCIsImF1dG9SZXNlYXJjaCI6MCwiYXV0b1NhY3JpZmljZSI6MCwic2FjcmlmaWNlVGltZXIiOjAuNjgwNzk5OTk5OTc4NDg1LCJxdWFya3N0aW1lciI6MC41Njg0MjQzNjU1NjU1ODA3LCJnb2xkZW5RdWFya3NUaW1lciI6OTAwMDAsImFudFBvaW50cyI6IjIuMzM5ODM0NTkyOTQyMTRlKzE5NDYiLCJhbnRVcGdyYWRlcyI6WzE5NDUsMTk0NSwxOTQ0LDE5NDQsOTcxLDk3MSw5NzAsOTY4LDY0NCw2NDMsNjM2LDE5XSwiYW50U2FjcmlmaWNlUG9pbnRzIjo0LjA4OTY5Mjg5MzYzOTk4MWUrNDIsImFudFNhY3JpZmljZVRpbWVyIjowLjAwMDAwMTkxODk1NzI3MzI5MTU0NCwiYW50U2FjcmlmaWNlVGltZXJSZWFsIjo1NTEwLjY4MDgwMDA5NjY0MywidGFsaXNtYW5MZXZlbHMiOls2MjgsNjI4LDYyOCw2MjgsNjI4LDYyOCw2MjhdLCJ0YWxpc21hblJhcml0eSI6WzYsNiw2LDYsNiw2LDZdLCJ0YWxpc21hbk9uZSI6W251bGwsMSwxLC0xLDEsLTFdLCJ0YWxpc21hblR3byI6W251bGwsMSwxLC0xLDEsLTFdLCJ0YWxpc21hblRocmVlIjpbbnVsbCwxLDEsLTEsMSwtMV0sInRhbGlzbWFuRm91ciI6W251bGwsMSwxLC0xLDEsLTFdLCJ0YWxpc21hbkZpdmUiOltudWxsLDEsMSwtMSwxLC0xXSwidGFsaXNtYW5TaXgiOltudWxsLDEsMSwtMSwxLC0xXSwidGFsaXNtYW5TZXZlbiI6W251bGwsMSwxLC0xLDEsLTFdLCJ0YWxpc21hblNoYXJkcyI6NC40OTY2NDY4NzIzNzM4OTE1ZSs2NywiY29tbW9uRnJhZ21lbnRzIjo3LjI5NjExMTI3MTEwNjI0ZSs2MiwidW5jb21tb25GcmFnbWVudHMiOjcuODE1OTEyNjg1NDQ1OTJlKzU3LCJyYXJlRnJhZ21lbnRzIjoyLjg5ODg3MDYyMTI0OTU3NmUrNTMsImVwaWNGcmFnbWVudHMiOjkuMTM2NDI2OTM0MTEzMDA4ZSs0OCwibGVnZW5kYXJ5RnJhZ21lbnRzIjozLjAyNTg5MTAyOTE0Mjc1NDdlKzQ0LCJteXRoaWNhbEZyYWdtZW50cyI6Mi40Njg5MTk3MTU2MjA3MjdlKzQwLCJidXlUYWxpc21hblNoYXJkUGVyY2VudCI6MTAwLCJhdXRvQW50U2FjcmlmaWNlIjpmYWxzZSwiYXV0b0FudFNhY1RpbWVyIjowLCJhdXRvQW50U2FjcmlmaWNlTW9kZSI6MiwiYW50TWF4Ijp0cnVlLCJhc2NlbnNpb25Db3VudCI6NDc4NDQ4MjI3MTE0OCwiYXNjZW5zaW9uQ291bnRlciI6MTAyMzM0MjAuODU4OTk1OTgzLCJjdWJlVXBncmFkZXMiOltudWxsLDQsMTAsNSwxLDEsMSwxLDEsMSwxLDQsMTAsMSwxMCwxMCwxMCw1LDEsMSwxLDYsMTAsMSwxMCwxMCwxMCwxLDEsNSwxLDYsMSwxLDEwLDEwLDEwLDEwLDEsMSwxMCw2LDEwLDEwLDEwLDEwLDIwLDIwLDEsMSwxMDAwMDAsMSw5MDAsMTAwLDkwMCw5MDAsMjAsMSwxLDQwMCwxMDAwMCwwLDAsMCwwLDAsMCwwLDAsMCwwXSwicGxhdG9uaWNVcGdyYWRlcyI6WzAsMTAwLDEwMCwxMDAsMTAwLDEsMTAsMTUsNSwxLDEsMSwxMCwxLDEsMSwxMDAsMjAsNDAsNTAsMV0sIndvd0N1YmVzIjoyLjA2MTEzNzQ4OTkwNjAxNzJlKzQ2LCJ3b3dUZXNzZXJhY3RzIjo0LjEyNDU5ODE4MDk2MjkzMmUrMjcsIndvd0h5cGVyY3ViZXMiOjMuMTE4NTMxMDA5NTQ0ODI5NmUrMjMsIndvd1BsYXRvbmljQ3ViZXMiOjMuMzMwNjUwMDg2OTU4ODQ1NWUrMjMsIndvd0FieXNzYWxzIjozMzE3MDAzNzczNzk1MTgsImN1YmVCbGVzc2luZ3MiOnsiYWNjZWxlcmF0b3IiOjEuNDA2NjMwNjE5MDY3NTUwMWUrNTAsIm11bHRpcGxpZXIiOjEuNDA2NjMwNjE5MDY3NTUwMWUrNTAsIm9mZmVyaW5nIjo3LjAzMzE1MzA5NTMzNzc1MWUrNDksInJ1bmVFeHAiOjcuMDMzMTUzMDk1MzM3NzUxZSs0OSwib2J0YWluaXVtIjo3LjAzMzE1MzA5NTMzNzc1MWUrNDksImFudFNwZWVkIjo3LjAzMzE1MzA5NTMzNzc1MWUrNDksImFudFNhY3JpZmljZSI6My41MTY1NzY1NDc2Njg4NzU0ZSs0OSwiYW50RUxPIjozLjUxNjU3NjU0NzY2ODg3NTRlKzQ5LCJ0YWxpc21hbkJvbnVzIjozLjUxNjU3NjU0NzY2ODg3NTRlKzQ5LCJnbG9iYWxTcGVlZCI6My41MTY1NzY1NDc2Njg4NzU0ZSs0OX0sInRlc3NlcmFjdEJsZXNzaW5ncyI6eyJhY2NlbGVyYXRvciI6Ni41ODM0NTUzMTMwMjkwNjVlKzI4LCJtdWx0aXBsaWVyIjo2LjU4MzQ1NTMxMzAyOTA2NWUrMjgsIm9mZmVyaW5nIjozLjI5MTcyNzY1NjUxNDUzMjZlKzI4LCJydW5lRXhwIjozLjI5MTcyNzY1NjUxNDUzMjZlKzI4LCJvYnRhaW5pdW0iOjMuMjkxNzI3NjU2NTE0NTMyNmUrMjgsImFudFNwZWVkIjozLjI5MTcyNzY1NjUxNDUzMjZlKzI4LCJhbnRTYWNyaWZpY2UiOjEuNjQ1ODYzODI4MjU3MjY2M2UrMjgsImFudEVMTyI6MS42NDU4NjM4MjgyNTcyNjYzZSsyOCwidGFsaXNtYW5Cb251cyI6MS42NDU4NjM4MjgyNTcyNjYzZSsyOCwiZ2xvYmFsU3BlZWQiOjEuNjQ1ODYzODI4MjU3MjY2M2UrMjh9LCJoeXBlcmN1YmVCbGVzc2luZ3MiOnsiYWNjZWxlcmF0b3IiOjEuOTIxOTcxNDA5NTI5MjA5NGUrMjYsIm11bHRpcGxpZXIiOjEuOTIxOTcxNDA5NTI5MjA5NGUrMjYsIm9mZmVyaW5nIjo5LjYwOTg1NzA0NzY0NjA0N2UrMjUsInJ1bmVFeHAiOjkuNjA5ODU3MDQ3NjQ2MDQ3ZSsyNSwib2J0YWluaXVtIjo5LjYwOTg1NzA0NzY0NjA0N2UrMjUsImFudFNwZWVkIjo5LjYwOTg1NzA0NzY0NjA0N2UrMjUsImFudFNhY3JpZmljZSI6NC44MDQ5Mjg1MjM4MjMwMjM1ZSsyNSwiYW50RUxPIjo0LjgwNDkyODUyMzgyMzAyMzVlKzI1LCJ0YWxpc21hbkJvbnVzIjo0LjgwNDkyODUyMzgyMzAyMzVlKzI1LCJnbG9iYWxTcGVlZCI6NC44MDQ5Mjg1MjM4MjMwMjM1ZSsyNX0sInBsYXRvbmljQmxlc3NpbmdzIjp7ImN1YmVzIjoxLjg2MzM0MjczNzczNDA3MjhlKzI2LCJ0ZXNzZXJhY3RzIjoxLjg2MzM0MjczNzczNDA3MjhlKzI2LCJoeXBlcmN1YmVzIjoxLjg2MzM0MjczNzczNDA3MjhlKzI2LCJwbGF0b25pY3MiOjUuNTkwMDI4MjEzMjAyMjE4ZSsyNCwiaHlwZXJjdWJlQm9udXMiOjEuNDExNjIzMjg2MTYyMTc2NGUrMjIsInRheGVzIjoxLjQxMTYyMzI4NjE2MjE3NjRlKzIyLCJzY29yZUJvbnVzIjoxLjQxMTYyMzI4NjE2MjE3NjRlKzIyLCJnbG9iYWxTcGVlZCI6MS40MTE2MjMyODYxNjIxNzY0ZSsyMn0sImhlcHRlcmFjdENyYWZ0cyI6eyJjaHJvbm9zIjp7IlVOTE9DS0VEIjp0cnVlLCJCQUwiOjE1NjEyNjgwODQxMzI2LCJDQVAiOjE3MTc5ODY5MTg0MDAwLCJCQVNFX0NBUCI6MTAwMCwiSEVQVEVSQUNUX0NPTlZFUlNJT04iOjEwMDAwLCJESVNDT1VOVCI6MCwiT1RIRVJfQ09OVkVSU0lPTlMiOnsicmVzZWFyY2hQb2ludHMiOjFlKzExNX19LCJoeXBlcnJlYWxpc20iOnsiVU5MT0NLRUQiOnRydWUsIkJBTCI6MTM0MjE3NzI4MDAwLCJDQVAiOjEzNDIxNzcyODAwMCwiQkFTRV9DQVAiOjEwMDAsIkhFUFRFUkFDVF9DT05WRVJTSU9OIjoxMDAwMCwiRElTQ09VTlQiOjAsIk9USEVSX0NPTlZFUlNJT05TIjp7InJ1bmVzaGFyZHMiOjFlKzgwfX0sInF1YXJrIjp7IlVOTE9DS0VEIjp0cnVlLCJCQUwiOjE2MDAwLCJDQVAiOjE2MDAwLCJCQVNFX0NBUCI6MTAwMCwiSEVQVEVSQUNUX0NPTlZFUlNJT04iOjEwMDAwLCJESVNDT1VOVCI6MCwiT1RIRVJfQ09OVkVSU0lPTlMiOnsid29ybGRzIjoxMDB9fSwiY2hhbGxlbmdlIjp7IlVOTE9DS0VEIjp0cnVlLCJCQUwiOjQyOTQ5NjcyOTYwMDAsIkNBUCI6NDI5NDk2NzI5NjAwMCwiQkFTRV9DQVAiOjEwMDAsIkhFUFRFUkFDVF9DT05WRVJTSU9OIjo1MDAwMCwiRElTQ09VTlQiOjAsIk9USEVSX0NPTlZFUlNJT05TIjp7Indvd1BsYXRvbmljQ3ViZXMiOjEwMDAwMDAwMDAwMCwid293Q3ViZXMiOjFlKzIyfX0sImFieXNzIjp7IlVOTE9DS0VEIjp0cnVlLCJCQUwiOjEsIkNBUCI6MjE0NzQ4MzY0OCwiQkFTRV9DQVAiOjEsIkhFUFRFUkFDVF9DT05WRVJTSU9OIjoxMDAwMDAwMDAsIkRJU0NPVU5UIjowLCJPVEhFUl9DT05WRVJTSU9OUyI6eyJ3b3dDdWJlcyI6Njl9fSwiYWNjZWxlcmF0b3IiOnsiVU5MT0NLRUQiOnRydWUsIkJBTCI6MTM0MjE3NzI4MDAwLCJDQVAiOjEzNDIxNzcyODAwMCwiQkFTRV9DQVAiOjEwMDAsIkhFUFRFUkFDVF9DT05WRVJTSU9OIjoxMDAwMDAsIkRJU0NPVU5UIjowLCJPVEhFUl9DT05WRVJTSU9OUyI6eyJ3b3dUZXNzZXJhY3RzIjoxMDAwMDAwMDAwMDAwMDB9fSwiYWNjZWxlcmF0b3JCb29zdCI6eyJVTkxPQ0tFRCI6dHJ1ZSwiQkFMIjo2NzEwODg2NDAwMCwiQ0FQIjo2NzEwODg2NDAwMCwiQkFTRV9DQVAiOjEwMDAsIkhFUFRFUkFDVF9DT05WRVJTSU9OIjoyMDAwMDAsIkRJU0NPVU5UIjowLCJPVEhFUl9DT05WRVJTSU9OUyI6eyJ3b3dIeXBlcmN1YmVzIjoxMDAwMDAwMDAwMH19LCJtdWx0aXBsaWVyIjp7IlVOTE9DS0VEIjp0cnVlLCJCQUwiOjMzNTU0NDMyMDAwLCJDQVAiOjMzNTU0NDMyMDAwLCJCQVNFX0NBUCI6MTAwMCwiSEVQVEVSQUNUX0NPTlZFUlNJT04iOjMwMDAwMCwiRElTQ09VTlQiOjAsIk9USEVSX0NPTlZFUlNJT05TIjp7InJlc2VhcmNoUG9pbnRzIjoxZSsxMzB9fX0sImFzY2VuZFNoYXJkcyI6IjIuMjkwMTAzNjE5NjI1NzRlKzIwMjUxMzIiLCJhdXRvQXNjZW5kIjpmYWxzZSwiYXV0b0FzY2VuZE1vZGUiOiJjMTBDb21wbGV0aW9ucyIsImF1dG9Bc2NlbmRUaHJlc2hvbGQiOjEsInJvb21iYVJlc2VhcmNoSW5kZXgiOjIwMCwiYXNjU3RhdFRvZ2dsZXMiOnsiMSI6ZmFsc2UsIjIiOmZhbHNlLCIzIjpmYWxzZSwiNCI6ZmFsc2UsIjUiOmZhbHNlfSwicHJvdG90eXBlQ29ycnVwdGlvbnMiOlswLDAsMTAsMTMsNywxMywxMywxMywxMywxMywwLDAsMF0sInVzZWRDb3JydXB0aW9ucyI6WzAsMCwxMCwxMyw3LDEzLDEzLDEzLDEzLDEzLDAsMCwwXSwiY29ycnVwdGlvbkxvYWRvdXRzIjp7IjEiOlswLDAsMTAsMTMsNywxMywxMywxMywxMywxMywwLDAsMF0sIjIiOlswLDAsMTMsMCwxMyw4LDEzLDEyLDEzLDEzLDAsMCwwXSwiMyI6WzAsMCwwLDAsMTMsMCwwLDAsMCwxMywwLDAsMF0sIjQiOlswLDAsNiw1LDEwLDgsMTMsMSwxMSwxMywwLDAsMF19LCJjb3JydXB0aW9uTG9hZG91dE5hbWVzIjpbIkhlcHQgcnVuIiwiT2ZmZXJpbmciLCJDMTMiLCJDdWJlIHJ1biJdLCJjb3JydXB0aW9uU2hvd1N0YXRzIjpmYWxzZSwiY29uc3RhbnRVcGdyYWRlcyI6W251bGwsMjAyNTEzMywyMDI1MTMyLDIwMjUxMzIsMjAyNTEzMCwyMDI1MTMwLDIwMjUxMjksMjAyNTEyOSwyMDI1MTI4LDIwMjUxMjMsMjAyNTEwOV0sImhpc3RvcnlTaG93UGVyU2Vjb25kIjp0cnVlLCJhdXRvQ2hhbGxlbmdlUnVubmluZyI6ZmFsc2UsImF1dG9DaGFsbGVuZ2VJbmRleCI6MSwiYXV0b0NoYWxsZW5nZVRvZ2dsZXMiOltmYWxzZSx0cnVlLHRydWUsdHJ1ZSx0cnVlLHRydWUsdHJ1ZSx0cnVlLHRydWUsdHJ1ZSx0cnVlLGZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlXSwiYXV0b0NoYWxsZW5nZVN0YXJ0RXhwb25lbnQiOjEwLCJhdXRvQ2hhbGxlbmdlVGltZXIiOnsic3RhcnQiOjAsImV4aXQiOjAuMiwiZW50ZXIiOjB9LCJydW5lQmxlc3NpbmdMZXZlbHMiOlswLDIuMTA3NDEwNTA0NDIwMTAwMmUrODUsMi4xMDc0MTA1MDQ0MjAyMDAyZSs4NSwyLjEwNzQxMDUwNDQyMDIwMDJlKzg1LDIuMTA3NDEwNTA0Mjc3NjcyM2UrODUsMi4xMDc0MTA1MDQyMjAxZSs4NV0sInJ1bmVTcGlyaXRMZXZlbHMiOlswLDEuMTg3NDEwNDIwMjIwMTAwMmUrNzgsMS44MDM1MDU4NDk0MzI3MmUrNzgsMS4xNzc0MTA0MzIxNTIzMTcxZSs3OCwxLjE3NzQxMDUxMDIyMDFlKzc4LDEuMTg3MTY2NjY2MTgzNTM4ZSs3OF0sInJ1bmVCbGVzc2luZ0J1eUFtb3VudCI6MWUrODUsInJ1bmVTcGlyaXRCdXlBbW91bnQiOjFlKzc4LCJhdXRvVGVzc2VyYWN0cyI6W2ZhbHNlLHRydWUsdHJ1ZSx0cnVlLHRydWUsdHJ1ZV0sInNhdmVTdHJpbmciOiJTeW5lcmdpc20tJFZFUlNJT04kLSRUSU1FJC50eHQiLCJleHBvcnR0ZXN0Ijp0cnVlLCJkYXlDaGVjayI6IjIwMjItMDUtMDZUMDY6MjI6NDcuOTM0WiIsImRheVRpbWVyIjo0OTEzLCJjdWJlT3BlbmVkRGFpbHkiOjEuMjkzNjQzNjQwMTI5OTExNmUrNDksImN1YmVRdWFya0RhaWx5Ijo0NjUxNCwidGVzc2VyYWN0T3BlbmVkRGFpbHkiOjcuMDg0MjA0NzIzMTg1OTY3NmUrMjgsInRlc3NlcmFjdFF1YXJrRGFpbHkiOjM4MjU0LCJoeXBlcmN1YmVPcGVuZWREYWlseSI6My44NDM1NTc0NzczMTkxMzJlKzI2LCJoeXBlcmN1YmVRdWFya0RhaWx5Ijo1MDM1NywicGxhdG9uaWNDdWJlT3BlbmVkRGFpbHkiOjIuMjgwMDg4NjQxNzYwMDMxZSsyNiwicGxhdG9uaWNDdWJlUXVhcmtEYWlseSI6NzQ4OTIsIm92ZXJmbHV4T3JicyI6MzAyNDc4NTk2MTkxLCJvdmVyZmx1eFBvd2RlciI6MTc1MzIyODQ0Ny40MTI1MzUyLCJkYWlseVBvd2RlclJlc2V0VXNlcyI6MCwibG9hZGVkT2N0NEhvdGZpeCI6dHJ1ZSwibG9hZGVkTm92MTNWZXJzIjp0cnVlLCJsb2FkZWREZWMxNlZlcnMiOnRydWUsImxvYWRlZFYyNTMiOnRydWUsImxvYWRlZFYyNTUiOnRydWUsInZlcnNpb24iOiIyLjkuMCIsInJuZ0NvZGUiOjE2NTE4NjMzMzYwMDYsInByb21vQ29kZVRpbWluZyI6eyJ0aW1lIjoxNjUxMjE4NjQ4MjAxfSwic2luZ3VsYXJpdHlDb3VudCI6MSwiZ29sZGVuUXVhcmtzIjo3Ny42OTIzMDAxNzY3MjE4LCJxdWFya3NUaGlzU2luZ3VsYXJpdHkiOjMxMTY5NTUuNDY5OTk5OTk2NSwiZGFpbHlDb2RlVXNlZCI6dHJ1ZX0=`;

    await loadSynergy(imp);

    this.subject.next(true);

    console.log(`player`, player);
    console.log(`player.worlds.BONUS`, player.worlds.BONUS);
    console.log('Gain', this.calculateGoldenQuarkGain());
  }

  getAscensionTimeAcceleration() {
    return calculateAscensionAcceleration();
  }

  getAscensionCubes(perSecond = false) {
    const [cubes, tess, hyper, platonic, hepteract] = CalcCorruptionStuff().slice(4);
    return perSecond ? cubes / player.ascensionCounter : cubes;
  }

  getAscensionHepteracts(perSecond = false) {
    const [cubes, tess, hyper, platonic, hepteract] = CalcCorruptionStuff().slice(4);
    return perSecond ? hepteract / player.ascensionCounter : hepteract;
  }

  getTotalHepteracts() {
    return this.getAscensionHepteracts(false) + player.wowAbyssals;
  }

  getOrbsPerPowder() {
    return 1 / calculatePowderConversion().mult;
  }

  getHepteractCraftCost(levels: number, cap: number, conversion: number) {
    let cost = 0;

    for (let i = 0; i < levels; i++) {
      cost += (cap * conversion);
      cap *= 2;
    }

    return cost;
  }

  calculateGoldenQuarkGain() {
    return calculateGoldenQuarkGain();
  }

  getMaxHepteractCraft(hepteracts: number, craft: 'chronos') {
    let cost = player.hepteractCrafts[craft].CAP * player.hepteractCrafts[craft].HEPTERACT_CONVERSION * 2;
    let levels = 0;

    while (hepteracts >= cost) {
      levels++;
      cost *= 2;
    }

    return levels;
  }

  chronosOrOrbs(chronosLevels?: number) {
    let maxChronosLevels = chronosLevels ?? this.getMaxHepteractCraft(this.getTotalHepteracts(), 'chronos');

    let currentPerSecond = this.getAscensionCubes(true);
    let newChronosCapCost = this.getHepteractCraftCost(maxChronosLevels, player.hepteractCrafts.chronos.CAP, player.hepteractCrafts.chronos.HEPTERACT_CONVERSION);
    let orbsForChronosCap = newChronosCapCost / 250000;
    let powderForOrbs = Math.floor(orbsForChronosCap / this.getOrbsPerPowder());

    player.overfluxPowder += powderForOrbs;
    let powderPerSecond = this.getAscensionCubes(true);
    player.overfluxPowder -= powderForOrbs;
    let orbsImprovement = powderPerSecond / currentPerSecond;

    let originalBalance = player.hepteractCrafts.chronos.BAL;
    let currentAcceleration = this.getAscensionTimeAcceleration();

    for (let i = 0; i < maxChronosLevels; i++) {
      player.hepteractCrafts.chronos.BAL *= 2;
    }

    let newAcceleration = this.getAscensionTimeAcceleration();
    player.hepteractCrafts.chronos.BAL = originalBalance;

    return {
      chronosPercent: newAcceleration / currentAcceleration,
      powderPercent: orbsImprovement,
      chronosLevels,
      orbs: orbsForChronosCap,
      powder: powderForOrbs,
    }
  }
}
